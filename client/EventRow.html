<!-- @format -->

<script>
  import Json from './Json.html'

  export let contract
  export let event
</script>

<style>
  .event {
    display: grid;
    grid-template-columns: 123px 1fr 1fr 235px;
  }
  .event > * {
    border: 1px solid var(--softblue);
    padding: 4px;
    margin: 2px;
    white-space: pre-wrap;
    word-wrap: break-word;
    word-break: break-all;
    display: flex;
    flex-direction: column;
    justify-items: center;
    align-items: center;
  }
  .event > * > * {
    margin: 4px 0;
  }
  .event:hover > * {
    background-color: var(--lightgrey);
  }
</style>

<div class="event">
  <div>
    <div>
      {#if event.contract !== contract}<a href="#/contract/{event.contract}"
        >{event.contract}</a
      >
      / {/if}{event.call}
    </div>
    <div>{event.time.split('T').join(' ').replace(/\..*/, '')}</div>
    <div>{event.caller || ''}</div>
  </div>
  <div>
    <div>{event.method}({parseInt(event.msatoshi/1000)}sat)</div>
    <Json value="{event.payload}" closed />
  </div>
  <div>{event.diff}</div>
  <table>
    {#each event.transfers as transfer}
    <tr>
      <td>{parseInt(transfer.msatoshi/1000)}sat</td>
      <td>{transfer.direction === 'out' ? 'to' : 'from'}</td>
      <td>{transfer.other}</td>
    </tr>
    {/each}
  </table>
</div>
