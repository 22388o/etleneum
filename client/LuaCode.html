<!-- @format -->

<script>
  import {onMount, onDestroy} from 'svelte'

  import hljs from 'highlight.js/lib/highlight'
  import lua from 'highlight.js/lib/languages/lua'
  hljs.registerLanguage('lua', lua)

  let id = parseInt(Math.random() * 100000)
  var source
  var target

  onMount(() => {
    source = document.getElementById('c-' + id + '-source')
    target = document.getElementById('c-' + id + '-target')

    let highlighted = hljs.highlight('lua', source.innerHTML)
    target.innerHTML = highlighted.value
    source.style.display = 'none'
  })

  onDestroy(() => {
    target.innerHTML = ''
    source.style.display = ''
  })
</script>

<style>
  code {
    font-size: 0.8rem;
  }
</style>

<svelte:head>
  <link rel=stylesheet
  href=https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.15.10/styles/github.min.css
  />
</svelte:head>
<pre>
  <code id="c-{id}-source">
    <slot></slot>
  </code>
</pre>
<pre>
  <code id="c-{id}-target">
  </code>
</pre>
